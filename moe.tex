Round 1

[MoE][Training] Epoch 1 | CE: 1.336 | LB: 0.008 | Router: 1.334 | Entropy: 1.343
[MoE][Training] Hard assignment counts per expert: [451, 98, 419, 1032]
[MoE][Training] Mean softmax probability per expert: [0.24801765382289886, 0.2143886685371399, 0.2348957508802414, 0.30269789695739746]
[MoE][Training] Epoch 2 | CE: 1.241 | LB: 0.008 | Router: 1.226 | Entropy: 1.277
[MoE][Training] Hard assignment counts per expert: [498, 133, 446, 923]
[MoE][Training] Mean softmax probability per expert: [0.2463160753250122, 0.21792685985565186, 0.22837132215499878, 0.30738574266433716]
[MoE][Training] Epoch 3 | CE: 1.122 | LB: 0.011 | Router: 1.098 | Entropy: 1.165
[MoE][Training] Hard assignment counts per expert: [512, 245, 435, 808]
[MoE][Training] Mean softmax probability per expert: [0.24605485796928406, 0.2187531441450119, 0.22874486446380615, 0.3064470887184143]
[MoE][Training] Epoch 4 | CE: 0.987 | LB: 0.017 | Router: 0.960 | Entropy: 1.054
[MoE][Training] Hard assignment counts per expert: [504, 310, 426, 760]
[MoE][Training] Mean softmax probability per expert: [0.2424612194299698, 0.2219979166984558, 0.22132116556167603, 0.31421971321105957]
[MoE][Training] Epoch 5 | CE: 0.836 | LB: 0.020 | Router: 0.817 | Entropy: 0.958
[MoE][Training] Hard assignment counts per expert: [510, 358, 418, 714]
[MoE][Training] Mean softmax probability per expert: [0.24530068039894104, 0.2155483514070511, 0.2223144769668579, 0.3168364465236664]
[MoE] Final routing distribution: {0: 409, 1: 346, 2: 481, 3: 764}
[MoE][testing] Per-expert accuracy after joint training: [0.6813417190775681, 0.6538461538461539, 0.8357843137254902, 0.8391248391248392]

[MoE] Confusion Matrix: Rows = True Class, Columns = Routed Expert
tensor([[323,  62,  56,  36],
[ 35, 224,  26,  53],
[ 15,  13, 348,  32],
[ 36,  47,  51, 643]])

Round 2 

[MoE][Training] Epoch 1 | CE: 1.331 | LB: 0.009 | Router: 1.333 | Entropy: 1.343
[MoE][Training] Hard assignment counts per expert: [492, 161, 309, 1038]
[MoE][Training] Mean softmax probability per expert: [0.24783200025558472, 0.2150765210390091, 0.23301814496517181, 0.304073303937912]
[MoE][Training] Epoch 2 | CE: 1.256 | LB: 0.008 | Router: 1.233 | Entropy: 1.285
[MoE][Training] Hard assignment counts per expert: [528, 254, 361, 857]
[MoE][Training] Mean softmax probability per expert: [0.24901264905929565, 0.2167016863822937, 0.2299281358718872, 0.30435746908187866]
[MoE][Training] Epoch 3 | CE: 1.168 | LB: 0.013 | Router: 1.123 | Entropy: 1.186
[MoE][Training] Hard assignment counts per expert: [520, 326, 401, 753]
[MoE][Training] Mean softmax probability per expert: [0.24968194961547852, 0.21525178849697113, 0.22882023453712463, 0.30624616146087646]
[MoE][Training] Epoch 4 | CE: 1.006 | LB: 0.015 | Router: 0.975 | Entropy: 1.067
[MoE][Training] Hard assignment counts per expert: [512, 345, 405, 738]
[MoE][Training] Mean softmax probability per expert: [0.24255582690238953, 0.22090840339660645, 0.22771744430065155, 0.30881837010383606]
[MoE][Training] Epoch 5 | CE: 0.866 | LB: 0.018 | Router: 0.838 | Entropy: 0.963
[MoE][Training] Hard assignment counts per expert: [517, 351, 411, 721]
[MoE][Training] Mean softmax probability per expert: [0.24541252851486206, 0.2100035697221756, 0.22686682641506195, 0.3177169859409332]
[MoE] Final routing distribution: {0: 425, 1: 309, 2: 443, 3: 823}
[MoE][testing] Per-expert accuracy after joint training: [0.7463312368972747, 0.6420118343195266, 0.7720588235294118, 0.9021879021879022]

[MoE] Confusion Matrix: Rows = True Class, Columns = Routed Expert
tensor([[352,  48,  36,  41],
[ 37, 227,  19,  55],
[ 15,  15, 332,  46],
[ 21,  19,  56, 681]])

Round 3

[MoE][Training] Epoch 1 | CE: 1.323 | LB: 0.008 | Router: 1.333 | Entropy: 1.335
[MoE][Training] Hard assignment counts per expert: [447, 246, 308, 999]
[MoE][Training] Mean softmax probability per expert: [0.2501910924911499, 0.21641528606414795, 0.22999019920825958, 0.30340325832366943]
[MoE][Training] Epoch 2 | CE: 1.239 | LB: 0.010 | Router: 1.222 | Entropy: 1.276
[MoE][Training] Hard assignment counts per expert: [457, 340, 369, 834]
[MoE][Training] Mean softmax probability per expert: [0.24662917852401733, 0.2152971625328064, 0.23238737881183624, 0.30568623542785645]
[MoE][Training] Epoch 3 | CE: 1.131 | LB: 0.011 | Router: 1.116 | Entropy: 1.185
[MoE][Training] Hard assignment counts per expert: [473, 422, 396, 709]
[MoE][Training] Mean softmax probability per expert: [0.24599651992321014, 0.22004909813404083, 0.23047901690006256, 0.30347543954849243]
[MoE][Training] Epoch 4 | CE: 0.995 | LB: 0.015 | Router: 0.981 | Entropy: 1.080
[MoE][Training] Hard assignment counts per expert: [486, 396, 405, 713]
[MoE][Training] Mean softmax probability per expert: [0.24706101417541504, 0.21103385090827942, 0.22974245250225067, 0.31216272711753845]
[MoE][Training] Epoch 5 | CE: 0.831 | LB: 0.016 | Router: 0.834 | Entropy: 0.968
[MoE][Training] Hard assignment counts per expert: [479, 400, 400, 721]
[MoE][Training] Mean softmax probability per expert: [0.2409818321466446, 0.21739916503429413, 0.22345171868801117, 0.3181672990322113]
[MoE] Final routing distribution: {0: 456, 1: 390, 2: 516, 3: 638}
[MoE][testing] Per-expert accuracy after joint training: [0.7379454926624738, 0.7781065088757396, 0.8161764705882353, 0.7696267696267697]

[MoE] Confusion Matrix: Rows = True Class, Columns = Routed Expert
tensor([[352,  42,  60,  23],
[ 27, 266,  32,  13],
[ 35,  16, 340,  17],
[ 42,  66,  84, 585]])

Round 4

[MoE][Training] Epoch 1 | CE: 1.346 | LB: 0.009 | Router: 1.363 | Entropy: 1.353
[MoE][Training] Hard assignment counts per expert: [358, 151, 296, 1195]
[MoE][Training] Mean softmax probability per expert: [0.24703876674175262, 0.21613222360610962, 0.234830841422081, 0.30199822783470154]
[MoE][Training] Epoch 2 | CE: 1.280 | LB: 0.006 | Router: 1.274 | Entropy: 1.314
[MoE][Training] Hard assignment counts per expert: [397, 228, 390, 985]
[MoE][Training] Mean softmax probability per expert: [0.24792402982711792, 0.21772834658622742, 0.23295791447162628, 0.3013896346092224]
[MoE][Training] Epoch 3 | CE: 1.186 | LB: 0.012 | Router: 1.151 | Entropy: 1.200
[MoE][Training] Hard assignment counts per expert: [484, 332, 394, 790]
[MoE][Training] Mean softmax probability per expert: [0.24919666349887848, 0.21525713801383972, 0.23024117946624756, 0.30530503392219543]
[MoE][Training] Epoch 4 | CE: 1.026 | LB: 0.014 | Router: 0.995 | Entropy: 1.094
[MoE][Training] Hard assignment counts per expert: [492, 347, 400, 761]
[MoE][Training] Mean softmax probability per expert: [0.24729159474372864, 0.21563035249710083, 0.2238956242799759, 0.31318244338035583]
[MoE][Training] Epoch 5 | CE: 0.872 | LB: 0.017 | Router: 0.848 | Entropy: 0.965
[MoE][Training] Hard assignment counts per expert: [490, 361, 428, 721]
[MoE][Training] Mean softmax probability per expert: [0.2422580122947693, 0.21186068654060364, 0.22726194560527802, 0.3186192512512207]
[MoE] Final routing distribution: {0: 615, 1: 203, 2: 426, 3: 756}
[MoE][testing] Per-expert accuracy after joint training: [0.8280922431865828, 0.5029585798816568, 0.7720588235294118, 0.8378378378378378]

[MoE] Confusion Matrix: Rows = True Class, Columns = Routed Expert
tensor([[399,  16,  31,  31],
[102, 174,  22,  40],
[ 31,   8, 326,  43],
[ 83,   5,  47, 642]])

Round 5

[MoE][Training] Epoch 1 | CE: 1.339 | LB: 0.011 | Router: 1.359 | Entropy: 1.347
[MoE][Training] Hard assignment counts per expert: [350, 157, 340, 1153]
[MoE][Training] Mean softmax probability per expert: [0.23927611112594604, 0.21953769028186798, 0.2361777424812317, 0.30500850081443787]
[MoE][Training] Epoch 2 | CE: 1.275 | LB: 0.008 | Router: 1.265 | Entropy: 1.315
[MoE][Training] Hard assignment counts per expert: [395, 84, 460, 1061]
[MoE][Training] Mean softmax probability per expert: [0.24693386256694794, 0.21645745635032654, 0.23176109790802002, 0.3048475384712219]
[MoE][Training] Epoch 3 | CE: 1.166 | LB: 0.011 | Router: 1.139 | Entropy: 1.197
[MoE][Training] Hard assignment counts per expert: [504, 271, 437, 788]
[MoE][Training] Mean softmax probability per expert: [0.2517864406108856, 0.21816454827785492, 0.22556084394454956, 0.3044881820678711]
[MoE][Training] Epoch 4 | CE: 1.043 | LB: 0.017 | Router: 1.026 | Entropy: 1.095
[MoE][Training] Hard assignment counts per expert: [478, 332, 441, 749]
[MoE][Training] Mean softmax probability per expert: [0.24436601996421814, 0.21985971927642822, 0.22642134130001068, 0.3093528747558594]
[MoE][Training] Epoch 5 | CE: 0.843 | LB: 0.016 | Router: 0.839 | Entropy: 0.974
[MoE][Training] Hard assignment counts per expert: [470, 380, 436, 714]
[MoE][Training] Mean softmax probability per expert: [0.24619005620479584, 0.21748550236225128, 0.22143103182315826, 0.31489333510398865]
[MoE] Final routing distribution: {0: 465, 1: 323, 2: 506, 3: 706}
[MoE][testing] Per-expert accuracy after joint training: [0.750524109014675, 0.6242603550295858, 0.8823529411764706, 0.7953667953667953]

[MoE] Confusion Matrix: Rows = True Class, Columns = Routed Expert
tensor([[360,  29,  54,  34],
[ 49, 221,  22,  46],
[ 16,   9, 360,  23],
[ 40,  64,  70, 603]])